{% extends "layout_internal.html" %}

{% block js_preload %}
<script type="module" src="{{ base_url | safe }}/ui/ui.js"></script>
{% endblock js_preload %}

{% block content %}
<div class="gisst-Instance-container">
    <div class="gisst-Instance-row">
        <h1>{{ work.work_name }} Instance Information</h1>
        <div class="gisst-Instance-info">
            <p><strong>Version:</strong> {{ work.work_version }}</p>
            <p><strong>Platform:</strong> {{ work.work_platform }}</p>
            <p><strong>Runtime:</strong> {{ environment.environment_framework }} - {{ environment.environment_core_name }} - {{ environment.environment_core_version }}</p>
        </div>
        <div class="gisst-Instance-action-buttons">
            <a class="gisst-Instance-btn gisst-Search-btn-primary" href="{{ base_url }}/play/{{ instance.instance_id }}" target="_blank">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polygon points="5 3 19 12 5 21 5 3"></polygon>
                </svg>
                Play
            </a>
            <a class="gisst-Instance-btn gisst-Search-btn-secondary" href="{{ base_url }}/play/{{ instance.instance_id }}?boot_into_record=true" target="_blank">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="10"/>
                    <circle cx="12" cy="12" r="4" fill="currentColor"/>
                </svg>
                Play and Record
            </a>
          <a class="gisst-Instance-btn gisst-Search-btn-primary" href="?{% if not creator_id %}creator_id={{user.creator_id}}&{% endif %}">{% if creator_id %}Show all users' states/performances{% else %}Show only my moments and performances{% endif %}</a>
        </div>
    </div>
    <div class="gisst-Instance-row">
        <div class="gisst-Instance-section-header">
            <h2>States</h2>
        </div>
      <gisst-state-search
        base-url="{{ base_url | safe }}"
        search-url="{{ search_url | safe }}"
        search-key="{{ search_key }}"
        instance-id="{{ instance.instance_id }}"
        instance-info="false"
        {% if creator_id %}
        creator-id="{{ creator_id }}"
        {% endif %}
        {% if environment.environment_framework == "v86" %}
        can-clone="true"
        {% endif %}
      ></gisst-state-search>
    </div>
    <div class="gisst-Instance-row">
        <div class="gisst-Instance-section-header">
            <h2>Performances</h2>
        </div>
      <gisst-performance-search
        base-url="{{ base_url | safe }}"
        search-url="{{ search_url | safe }}"
        search-key="{{ search_key }}"
        instance-id="{{ instance.instance_id }}"
        instance-info="false"
        {% if creator_id %}
        creator-id="{{ creator_id }}"
        {% endif %}
      ></gisst-performance-search>
    </div>
    <div class="gisst-Instance-row">
        <div class="gisst-Instance-section-header">
            <h2>Saves</h2>
        </div>
      <gisst-save-search
        base-url="{{ base_url | safe }}"
        search-url="{{ search_url | safe }}"
        search-key="{{ search_key }}"
        instance-id="{{ instance.instance_id }}"
        instance-info="false"
        {% if creator_id %}
        creator-id="{{ creator_id }}"
        {% endif %}
      ></gisst-save-search>
    </div>
    <div class="gisst-Instance-row">
        <h1>Data Objects</h1>
        <table class="gisst-Instance-data-table">
            <thead>
                <tr>
                    <th scope="col">File</th>
                    <th scope="col">Role</th>
                    <th scope="col">Index</th>
                    <th scope="col">Source Path</th>
                </tr>
            </thead>
            <tbody>
            {% for data in objects %}
            <tr>
                <td><a href="{{ base_url }}/objects/{{ data.object_id }}">{{ data.file_filename }}</a></td>
                <td>{{ data.object_role }}</td>
                <td>{{ data.object_role_index }}</td>
                <td>{{ data.file_source_path }}</td>
            </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock content %}
